<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="IoT project code & docs.
# Repository"><meta name=author content="Alexander A. Parvanov"><link href=https://46265z.github.io/IoT-dev-setup/devices/lopy4/ rel=canonical><link rel=icon href=../../assets/favicon.png><meta name=generator content="mkdocs-1.3.0, mkdocs-material-8.2.13"><title>LoPy4 - IoT-dev-setup</title><link rel=stylesheet href=../../assets/stylesheets/main.e411adfe.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.cc9b2e1e.min.css><meta name=theme-color content=#4051b5><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#lopy4 class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title=IoT-dev-setup class="md-header__button md-logo" aria-label=IoT-dev-setup data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 89 89"> <path d=M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z /> <path d=M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z style="fill-opacity: 0.5"/> <path d=M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z /> <path d=M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z style="fill-opacity: 0.25"/> </svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> IoT-dev-setup </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> LoPy4 </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/46265z/IoT-dev-setup title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> 46265z/IoT-dev-setup </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../prerequisites/ class=md-tabs__link> Prerequisites </a> </li> <li class=md-tabs__item> <a href=../../setup-device/ class=md-tabs__link> How To </a> </li> <li class=md-tabs__item> <a href=./ class="md-tabs__link md-tabs__link--active"> Devices </a> </li> <li class=md-tabs__item> <a href=../../telemetry/mqtt/ class=md-tabs__link> Telemetry </a> </li> <li class=md-tabs__item> <a href=../../modules/mh-rtc-2/ class=md-tabs__link> Modules </a> </li> <li class=md-tabs__item> <a href=../list-of-devices/ class=md-tabs__link> List </a> </li> <li class=md-tabs__item> <a href=../../spectra-eit/spectra-eit/ class=md-tabs__link> Spectra EIT Kit </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=IoT-dev-setup class="md-nav__button md-logo" aria-label=IoT-dev-setup data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 89 89"> <path d=M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z /> <path d=M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z style="fill-opacity: 0.5"/> <path d=M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z /> <path d=M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z style="fill-opacity: 0.25"/> </svg> </a> IoT-dev-setup </label> <div class=md-nav__source> <a href=https://github.com/46265z/IoT-dev-setup title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> 46265z/IoT-dev-setup </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> Home </a> </li> <li class=md-nav__item> <a href=../../prerequisites/ class=md-nav__link> Prerequisites </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3> How To <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="How To" data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> How To </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../setup-device/ class=md-nav__link> Setup device </a> </li> <li class=md-nav__item> <a href=../../connect-device/ class=md-nav__link> Connect device </a> </li> <li class=md-nav__item> <a href=../../setup-pybytes-project/ class=md-nav__link> Setup Pybytes project </a> </li> <li class=md-nav__item> <a href=../../import-code-from-github/ class=md-nav__link> Import </a> </li> <li class=md-nav__item> <a href=../../deploy-to-edge-device/ class=md-nav__link> Deploy </a> </li> <li class=md-nav__item> <a href=../../integrate-webhook/ class=md-nav__link> Integrate webhook </a> </li> <li class=md-nav__item> <a href=../../test-pybytes-webhook/ class=md-nav__link> Test the hook(Mock webhook service/backend/endpoint) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 type=checkbox id=__nav_4 checked> <label class=md-nav__link for=__nav_4> Devices <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Devices data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Devices </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> LoPy4 <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> LoPy4 </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#-usb class=md-nav__link> Работа с у-вото през USB </a> <nav class=md-nav aria-label="Работа с у-вото през USB"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_1 class=md-nav__link> Нужни </a> </li> <li class=md-nav__item> <a href=#_2 class=md-nav__link> Подготовка </a> <nav class=md-nav aria-label=Подготовка> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_3 class=md-nav__link> Хардуер </a> </li> <li class=md-nav__item> <a href=#_4 class=md-nav__link> Софтуер </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_5 class=md-nav__link> Програмиране на модула </a> <nav class=md-nav aria-label="Програмиране на модула"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#micropython-pymakr class=md-nav__link> Създаване на MicroPython проект с Pymakr </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#-pybytes class=md-nav__link> Работа с у-вото през PyBytes </a> <nav class=md-nav aria-label="Работа с у-вото през PyBytes"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_6 class=md-nav__link> Нужни </a> </li> <li class=md-nav__item> <a href=#_7 class=md-nav__link> Стъпки за създаване на проект </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_8 class=md-nav__link> Безжична свързаност </a> <nav class=md-nav aria-label="Безжична свързаност"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#access-point-mode class=md-nav__link> Access point mode </a> </li> <li class=md-nav__item> <a href=#station-mode class=md-nav__link> Station mode </a> </li> <li class=md-nav__item> <a href=#_9 class=md-nav__link> Сканиране и свъзване към мрежа </a> </li> <li class=md-nav__item> <a href=#ip class=md-nav__link> Задаване на статичен IP адрес </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#pybytes class=md-nav__link> Изпращане на данни към PyBytes </a> </li> <li class=md-nav__item> <a href=#mqtt class=md-nav__link> Свързване към MQTT </a> </li> <li class=md-nav__item> <a href=#pybytes-third-party-mqtt-broker class=md-nav__link> PyBytes + third party MQTT Broker </a> </li> <li class=md-nav__item> <a href=#python class=md-nav__link> Приемане на данни в Python скрипта </a> <nav class=md-nav aria-label="Приемане на данни в Python скрипта"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_10 class=md-nav__link> Препращане на данни към БД </a> <nav class=md-nav aria-label="Препращане на данни към БД"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#mongodb-cloud class=md-nav__link> MongoDB Cloud </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_11 class=md-nav__link> Интегриране с услуги предоставени от трети страни </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../pyscan/ class=md-nav__link> Pyscan </a> </li> <li class=md-nav__item> <a href=../pysense2x/ class=md-nav__link> Pysense2x </a> </li> <li class=md-nav__item> <a href=../pytrack2x/ class=md-nav__link> Pytrack2x </a> </li> <li class=md-nav__item> <a href=../higrow-wroom32/ class=md-nav__link> Higrow wroom32 </a> </li> <li class=md-nav__item> <a href=../uno-wifi/ class=md-nav__link> UNO WIFI </a> </li> <li class=md-nav__item> <a href=../SIM800A/ class=md-nav__link> SIM800A </a> </li> <li class=md-nav__item> <a href=../wemos-lolin/ class=md-nav__link> Wemos Lolin </a> </li> <li class=md-nav__item> <a href=../smart-watering/ class=md-nav__link> Smart Watering </a> </li> <li class=md-nav__item> <a href=../sodaq-sara-aff/ class=md-nav__link> Sodaq Sara </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5 type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5> Telemetry <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Telemetry data-md-level=1> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Telemetry </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../telemetry/mqtt/ class=md-nav__link> MQTT </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_6 type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6> Modules <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Modules data-md-level=1> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Modules </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../modules/mh-rtc-2/ class=md-nav__link> MH-RTC-2 </a> </li> <li class=md-nav__item> <a href=../../modules/next-mod-template/ class=md-nav__link> Next-mod </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_7 type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7> List <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=List data-md-level=1> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> List </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../list-of-devices/ class=md-nav__link> Device list </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../spectra-eit/spectra-eit/ class=md-nav__link> Spectra EIT Kit </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#-usb class=md-nav__link> Работа с у-вото през USB </a> <nav class=md-nav aria-label="Работа с у-вото през USB"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_1 class=md-nav__link> Нужни </a> </li> <li class=md-nav__item> <a href=#_2 class=md-nav__link> Подготовка </a> <nav class=md-nav aria-label=Подготовка> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_3 class=md-nav__link> Хардуер </a> </li> <li class=md-nav__item> <a href=#_4 class=md-nav__link> Софтуер </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_5 class=md-nav__link> Програмиране на модула </a> <nav class=md-nav aria-label="Програмиране на модула"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#micropython-pymakr class=md-nav__link> Създаване на MicroPython проект с Pymakr </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#-pybytes class=md-nav__link> Работа с у-вото през PyBytes </a> <nav class=md-nav aria-label="Работа с у-вото през PyBytes"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_6 class=md-nav__link> Нужни </a> </li> <li class=md-nav__item> <a href=#_7 class=md-nav__link> Стъпки за създаване на проект </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_8 class=md-nav__link> Безжична свързаност </a> <nav class=md-nav aria-label="Безжична свързаност"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#access-point-mode class=md-nav__link> Access point mode </a> </li> <li class=md-nav__item> <a href=#station-mode class=md-nav__link> Station mode </a> </li> <li class=md-nav__item> <a href=#_9 class=md-nav__link> Сканиране и свъзване към мрежа </a> </li> <li class=md-nav__item> <a href=#ip class=md-nav__link> Задаване на статичен IP адрес </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#pybytes class=md-nav__link> Изпращане на данни към PyBytes </a> </li> <li class=md-nav__item> <a href=#mqtt class=md-nav__link> Свързване към MQTT </a> </li> <li class=md-nav__item> <a href=#pybytes-third-party-mqtt-broker class=md-nav__link> PyBytes + third party MQTT Broker </a> </li> <li class=md-nav__item> <a href=#python class=md-nav__link> Приемане на данни в Python скрипта </a> <nav class=md-nav aria-label="Приемане на данни в Python скрипта"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_10 class=md-nav__link> Препращане на данни към БД </a> <nav class=md-nav aria-label="Препращане на данни към БД"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#mongodb-cloud class=md-nav__link> MongoDB Cloud </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_11 class=md-nav__link> Интегриране с услуги предоставени от трети страни </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/46265z/IoT-dev-setup/edit/master/docs/devices/lopy4.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg> </a> <h1 id=lopy4>LoPy<sup>4</sup><a class=headerlink href=#lopy4 title="Permanent link">&para;</a></h1> <p>LoPy<sup>4</sup> е програмируема платка поддържаща 4 различни вида мрежи за пренос на данни. Работи с LoRa, Sigfox, WiFi и Bluetooth <strong>(BLE?)</strong>. Поради това тя е особено подходяща за IoT проекти от висок клас (enterprise-grade). Програмира се с MicroPython.</p> <p><a href=https://docs.pycom.io/datasheets/development/lopy4/ >Product page</a> <a href=https://docs.pycom.io/gitbook/assets/specsheets/Pycom_002_Specsheets_LoPy4_v2.pdf>Datasheet</a> <a href=https://docs.pycom.io/gitbook/assets/lopy4-pinout.pdf>Pinout</a></p> <p><img alt=lopy4-resized-removebg-preview src=https://user-images.githubusercontent.com/47386361/148212731-c2cac252-3958-4a18-be67-c3dd899a0563.png></p> <hr> <div class="admonition type danger"> <p class=admonition-title>Когато използвате безжична връзка LoRa или Sigfox, винаги поставяйте подходяща антена!</p> </div> <div class="admonition type info"> <p class=admonition-title>При използване на WiFi или Bluetooth използването на външна антена не е задължително, освен когато изрично посочим това в кода.</p> </div> <h2 id=-usb>Работа с у-вото през USB<a class=headerlink href=#-usb title="Permanent link">&para;</a></h2> <p>Ако не разполагаме с разширителна платка е възможно да достъпим модула чрез USB-Serial конвертор (<a href=https://docs.pycom.io/gettingstarted/programming/usbserial/ >вижте как</a>).</p> <h3 id=_1>Нужни<a class=headerlink href=#_1 title="Permanent link">&para;</a></h3> <!-- - [Atom](https://atom.io/) --> <ul> <li>Putty</li> <li>Visual Studio Code</li> <li>Pymakr VSCode Extension</li> <li>Прочете <a href=https://docs.pycom.io/gettingstarted/software/ >официалния урок</a> за настройване на работна среда</li> <li>LoPy<sup>4</sup></li> <li>Expansion Board</li> <li>USB кабел тип Micro-B</li> </ul> <h3 id=_2>Подготовка<a class=headerlink href=#_2 title="Permanent link">&para;</a></h3> <p>Преди да започнем да програмиране модула, трябва да подготвим средата за работа и хардуера с който ще работим.</p> <h4 id=_3>Хардуер<a class=headerlink href=#_3 title="Permanent link">&para;</a></h4> <p>Свързваме модула към разширителната платка (в случая ще използваме Expansion Board 3.0), като LED на модула трябва да застане над USB буксата на разширителнат. След това просто включваме USB кабела към PC.</p> <div class="admonition type info"> <p class=admonition-title>Когато включите модула, вграденият светодиод мига на равни интервали в синьо. Този "сърдечен ритъм" (heartbeat) се използва като начин да се разбере, че модулът е заредил и е стартирал правилно.</p> </div> <p><em>Снимка, а най-добре гиф който да показва как</em></p> <h4 id=_4>Софтуер<a class=headerlink href=#_4 title="Permanent link">&para;</a></h4> <p>Трябва да имате инсталиран VSCode и екстеншъна Pymakr. Вижте как <a href=https://docs.pycom.io/gettingstarted/software/vscode/ >тук</a></p> <h3 id=_5>Програмиране на модула<a class=headerlink href=#_5 title="Permanent link">&para;</a></h3> <p>За начало ще използваме Python REPL-а за да изпълним няколко команди. След като сме свързали платката към PC, пуснете Putty и установете серийна връзка към съответния COM порт. Ако не виждате <code>&gt;&gt;&gt;</code> просто цъкнете Enter веднъж.</p> <p>Командите които ще изпълним са следните <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>pycom</span>
<span class=n>pycom</span><span class=o>.</span><span class=n>heartbeat</span><span class=p>(</span><span class=kc>False</span><span class=p>)</span>
<span class=n>pycom</span><span class=o>.</span><span class=n>rgbled</span><span class=p>(</span><span class=mh>0x330033</span><span class=p>)</span>
</code></pre></div> <img alt=lopy4-putty-repl src=https://user-images.githubusercontent.com/47386361/148545282-01135d1a-98c3-450b-81ce-91fdf0ba3b6e.png></p> <p>В резултат, LED на у-вото трябва да светне в лилав цвят.</p> <p>Същото можем да постигнем изплзвайки REPL-a който ще намерим във VSCode.</p> <p><img alt=lopy4-vscode-repl src=https://user-images.githubusercontent.com/47386361/148545302-0a86f1ae-b157-45eb-813b-990d08dff201.png></p> <hr> <p>За да бъде работата с устройството по-приятна, а разбира се и по-продуктивна, <strong>трябва</strong> да използваме разширението за VSCode - Pymakr. То позволява да направим проект представен от директория, в която има конфигурационен файл за серийната връзка и кода който искаме да има на устройството. Освен това, чрез него можем да качим целия си проект чрез цъкване на 1 единствен бутон, ако се чудите как става в противен случай провете в интернет ("ръчното" качване на код е времеотнемащ процес).</p> <h4 id=micropython-pymakr>Създаване на MicroPython проект с Pymakr<a class=headerlink href=#micropython-pymakr title="Permanent link">&para;</a></h4> <p>Обикновено един такъв проект съдържа поддиректория <code>lib</code> която съдържа допълнителни библиотеки написани от нас или от някой друг и два <code>.py</code> файла - <code>boot.py</code>и <code>main.py</code>. Както името подсказва, първият се изпълянва в момента в който платката бъде пусната, а <code>main.py</code> файла е мястото къде се изпълнява основния код.</p> <p>Стъпките при създаване на проект са следните:</p> <ol> <li> <p>Създаваме нова директория. Моята се казва RGBLED-Blink. Това е главната директория на проекта.</p> </li> <li> <p>В нея създайте папка <code>lib</code>, може да бъде празна.</p> </li> <li> <p>Създйате създайте двата <code>.py</code> файла.</p> </li> <li> <p>Отворете главната директория във VSCode.</p> </li> </ol> <p>Задачата която ще осъществим чрез този проект е да контролираме вградения LED.</p> <p>Кодът за този пример ще пишем в <code>main.py</code>:</p> <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>pycom</span>
<span class=kn>import</span> <span class=nn>time</span>
</code></pre></div> <p><code>Pycom</code> библиотеката отговаря за специфични за тези у-ва възможности. Начина по който контролираме вградения LED е една от тях. Библиотеката <code>time</code> е стандартната за <code>Python</code> - отговаря за тайминга и времеви забавяния (timing and delays).</p> <div class="admonition type info"> <p class=admonition-title>Преди да променяме цвета на светодиода трябва да изключим heartbeat-а.</p> </div> <div class=highlight><pre><span></span><code><span class=n>pycom</span><span class=o>.</span><span class=n>heartbeat</span><span class=p>(</span><span class=kc>False</span><span class=p>)</span>
</code></pre></div> <p>Нека тестваме кода който написахме до тук. В най-долната синя лента на VSCode има бутон <code>Run</code>, както и бутон <code>Upload</code>, ще използваме бутона <code>run</code>. Разликата е в това, че <code>run</code> компилира кода и го изпълнява на у-вото <strong>без да го запазва</strong> във flash паметта, докато <code>upload</code> го запазва (качва го на у-вото).</p> <p><em>Снимка lopy-vscode-run-upload</em></p> <p>След като цъкнем <code>run</code> "сърдечния ритъм" на устройството ще спре.</p> <p>Нека довършим скрипта като <code>while</code> loop в който променяме цвета на светодиода. Следва цялостния код за примера:</p> <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>pycom</span>
<span class=kn>import</span> <span class=nn>time</span>

<span class=n>pycom</span><span class=o>.</span><span class=n>heartbeat</span><span class=p>(</span><span class=kc>False</span><span class=p>)</span>

<span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
    <span class=c1>#colors in hexadecimal (0xRRGGBB)</span>
    <span class=n>pycom</span><span class=o>.</span><span class=n>rgbled</span><span class=p>(</span><span class=mh>0xFF0000</span><span class=p>)</span>  <span class=c1># Red</span>
    <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
    <span class=n>pycom</span><span class=o>.</span><span class=n>rgbled</span><span class=p>(</span><span class=mh>0x00FF00</span><span class=p>)</span>  <span class=c1># Green</span>
    <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
    <span class=n>pycom</span><span class=o>.</span><span class=n>rgbled</span><span class=p>(</span><span class=mh>0x0000FF</span><span class=p>)</span>  <span class=c1># Blue</span>
    <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</code></pre></div> <p>За да спрете изпълнението на скрипта, фокусирайте терминала и натиснете <code>Ctrl+C</code>.</p> <p>Ако рестартирате у-вото от бутона му, ще видите, че "сърдечния ритъм" отново е на лице, а цветовете които зададохме ние ги няма. За да променим това трябва просто да използваме бутона <code>upload</code>. След това дори след рестарт кода ще е в устройството и ще бъде изпълнен.</p> <p><em>Snimka lopy-vscode-upload-cpde</em></p> <h2 id=-pybytes>Работа с у-вото през PyBytes<a class=headerlink href=#-pybytes title="Permanent link">&para;</a></h2> <h3 id=_6>Нужни<a class=headerlink href=#_6 title="Permanent link">&para;</a></h3> <ul> <li>LoPy<sup>4</sup></li> <li>Expansion Board</li> <li>USB кабел тип Micro-B</li> <li>Регистрация в <a href=https://pybytes.pycom.io/ >PyBytes</a></li> <li>2.4GHz безжична мрежа (препоръчително е да не е основната която използвате, тъй като паролата е видима в някои моменти)</li> <li><a href=https://pycom.io/downloads/#firmware>PyCom Firmware Update Tool</a></li> </ul> <p>Аналогично на проекта който създадохме локално във VSCode, ще създадем проект в PyBytes.</p> <h3 id=_7>Стъпки за създаване на проект<a class=headerlink href=#_7 title="Permanent link">&para;</a></h3> <ul> <li>В уеб интерфейса конфигурираме безжичната мрежа към която у-вото ще бъде свързвано.</li> <li>Добавяме(създаваме) у-во към (в) PyBytes.<ul> <li>Избираме метод за активация. Най-често аз избирам offline activation.</li> </ul> </li> <li>Отново от уеб интерфейса избираме <strong>Create project</strong>. Посочете мрежата която конфигурирахте по-рано.</li> <li>Добавяме у-вото към проекта.</li> </ul> <p><img alt=pybytes-add-device-create-project-how-to src=https://user-images.githubusercontent.com/47386361/148545380-95a8a684-5bcc-4973-ad75-e027665d7f4f.gif></p> <p>От сега нататък можем да променяме конфигурацията на у-вото, да качваме нов код както и да обновяваме фирмуера изцяло Over-The-Air.</p> <h2 id=_8>Безжична свързаност<a class=headerlink href=#_8 title="Permanent link">&para;</a></h2> <p>В почти всеки случай кода за свързване към мрежата трябва да бъде в <code>boot.py</code>.</p> <h3 id=access-point-mode>Access point mode<a class=headerlink href=#access-point-mode title="Permanent link">&para;</a></h3> <h3 id=station-mode>Station mode<a class=headerlink href=#station-mode title="Permanent link">&para;</a></h3> <h3 id=_9>Сканиране и свъзване към мрежа<a class=headerlink href=#_9 title="Permanent link">&para;</a></h3> <p>В <code>boot.py</code>:</p> <div class=highlight><pre><span></span><code><span class=kn>from</span> <span class=nn>network</span> <span class=kn>import</span> <span class=n>WLAN</span>
<span class=kn>import</span> <span class=nn>machine</span>
<span class=n>wlan</span> <span class=o>=</span> <span class=n>WLAN</span><span class=p>(</span><span class=n>mode</span><span class=o>=</span><span class=n>WLAN</span><span class=o>.</span><span class=n>STA</span><span class=p>)</span>

<span class=n>nets</span> <span class=o>=</span> <span class=n>wlan</span><span class=o>.</span><span class=n>scan</span><span class=p>()</span>
<span class=k>for</span> <span class=n>net</span> <span class=ow>in</span> <span class=n>nets</span><span class=p>:</span>
    <span class=k>if</span> <span class=n>net</span><span class=o>.</span><span class=n>ssid</span> <span class=o>==</span> <span class=s1>&#39;&lt;Your-Wifi-SSID&gt;&#39;</span><span class=p>:</span> <span class=c1># &lt;Your-Wifi-SSID&gt; е името на вашата мрежа</span>
        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;[INFO]</span><span class=se>\t</span><span class=s1>Network found!&#39;</span><span class=p>)</span>
        <span class=n>wlan</span><span class=o>.</span><span class=n>connect</span><span class=p>(</span><span class=n>net</span><span class=o>.</span><span class=n>ssid</span><span class=p>,</span> <span class=n>auth</span><span class=o>=</span><span class=p>(</span><span class=n>net</span><span class=o>.</span><span class=n>sec</span><span class=p>,</span> <span class=s1>&#39;&lt;yourWifiKey&gt;&#39;</span><span class=p>),</span> <span class=n>timeout</span><span class=o>=</span><span class=mi>5000</span><span class=p>)</span> <span class=c1># &lt;yourWifiKey&gt; Трябва да бъде паролата за вашата мрежа</span>
        <span class=k>while</span> <span class=ow>not</span> <span class=n>wlan</span><span class=o>.</span><span class=n>isconnected</span><span class=p>():</span>
            <span class=n>machine</span><span class=o>.</span><span class=n>idle</span><span class=p>()</span> <span class=c1># save power while waiting</span>
        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;[INFO]</span><span class=se>\t</span><span class=s1>WLAN connection succeeded!&#39;</span><span class=p>)</span>
        <span class=k>break</span>
    <span class=k>else</span><span class=p>:</span>
        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;[WARNING]</span><span class=se>\t</span><span class=s1>The network you are searching for could not be found.&#39;</span><span class=p>)</span>
        <span class=k>break</span>
</code></pre></div> <p>Резултата наблюдаван в <code>Pymakr Console</code> във <code>VSCode</code>:</p> <p><img alt=lopy-scan-and-connect-to-network src=https://user-images.githubusercontent.com/47386361/148642807-7c33d6cf-94c8-4fe0-a501-6e4e0eafa303.png></p> <p>Импортваме нужните библиотеки <div class=highlight><pre><span></span><code><span class=kn>from</span> <span class=nn>network</span> <span class=kn>import</span> <span class=n>WLAN</span>
<span class=kn>import</span> <span class=nn>machine</span>
</code></pre></div></p> <p>Инстанциираме класа <code>WLAN</code> в режим на клиент <div class=highlight><pre><span></span><code><span class=n>wlan</span> <span class=o>=</span> <span class=n>WLAN</span><span class=p>(</span><span class=n>mode</span><span class=o>=</span><span class=n>WLAN</span><span class=o>.</span><span class=n>STA</span><span class=p>)</span>
</code></pre></div></p> <p>Сканираме наличните мрежи и запазваме резултата от сканирането в <code>list</code> <div class=highlight><pre><span></span><code><span class=n>nets</span> <span class=o>=</span> <span class=n>wlan</span><span class=o>.</span><span class=n>scan</span><span class=p>()</span>
</code></pre></div></p> <p>За всяка от намерените мрежи извършваме проверка търсейки мрежа със <code>SSID</code> което ни интересува. Ако мрежата е налична принтим информационно съобщение за това и инициализираме свързване към нея.</p> <div class=highlight><pre><span></span><code><span class=k>for</span> <span class=n>net</span> <span class=ow>in</span> <span class=n>nets</span><span class=p>:</span>
    <span class=k>if</span> <span class=n>net</span><span class=o>.</span><span class=n>ssid</span> <span class=o>==</span> <span class=s1>&#39;&lt;Your-Wifi-SSID&gt;&#39;</span><span class=p>:</span> <span class=c1># &lt;Your-Wifi-SSID&gt; е името на вашата мрежа</span>
        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;[INFO]</span><span class=se>\t</span><span class=s1>Network found!&#39;</span><span class=p>)</span>
        <span class=n>wlan</span><span class=o>.</span><span class=n>connect</span><span class=p>(</span><span class=n>net</span><span class=o>.</span><span class=n>ssid</span><span class=p>,</span> <span class=n>auth</span><span class=o>=</span><span class=p>(</span><span class=n>net</span><span class=o>.</span><span class=n>sec</span><span class=p>,</span> <span class=s1>&#39;&lt;yourWifiKey&gt;&#39;</span><span class=p>),</span> <span class=n>timeout</span><span class=o>=</span><span class=mi>5000</span><span class=p>)</span> <span class=c1># &lt;yourWifiKey&gt; Трябва да бъде паролата за вашата мрежа</span>
</code></pre></div> <p>Проверяваме състоянието, като докато НЕ е свързвано задаваме състояние на процесора <code>idle</code> за да пестим енергия. При успешно свързване принтим <code>[INFO]</code> съобщение и излизаме от проверката. <div class=highlight><pre><span></span><code>        <span class=k>while</span> <span class=ow>not</span> <span class=n>wlan</span><span class=o>.</span><span class=n>isconnected</span><span class=p>():</span>
            <span class=n>machine</span><span class=o>.</span><span class=n>idle</span><span class=p>()</span> <span class=c1># save power while waiting</span>
        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;[INFO]</span><span class=se>\t</span><span class=s1>WLAN connection succeeded!&#39;</span><span class=p>)</span>
        <span class=k>break</span>
</code></pre></div></p> <p>Ако мрежата не е открита се отразява в терминала чрез съобщение от тип <code>[WARNING]</code>. <div class=highlight><pre><span></span><code>    <span class=k>else</span><span class=p>:</span>
        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;[WARNING]</span><span class=se>\t</span><span class=s1>The network you are searching for could not be found.&#39;</span><span class=p>)</span>
        <span class=k>break</span>
</code></pre></div></p> <p>Понеже използвам вторична мрежа за у-вата, ще мога да видя устройство в интерфейса на рутера свързано към <code>Wireless interface - wlan2</code>.</p> <p><img alt=snimka-ot-WinBox-na-ustroistvoto-svurzano-kym-mrejata src=https://user-images.githubusercontent.com/47386361/148642817-ce43a035-9f76-4e0e-b550-ebaaf598c61b.png></p> <h3 id=ip>Задаване на статичен IP адрес<a class=headerlink href=#ip title="Permanent link">&para;</a></h3> <p>Ако искате да достъпвате у-вото чрез някакъв отдалечен достъп различен от pyBytes, ще е по-лесно да има статично ИП.</p> <div class="admonition type danger"> <p class=admonition-title>Обърнете внимание как проверяваме причината за рестартиране и състоянието на връзката - това е от решаващо значение, за да можем да рестартираме LoPy програмно по време на Telnet сесия, без да прекъсваме връзката.</p> </div> <p>В <code>boot.py</code>: <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>machine</span>
<span class=kn>import</span> <span class=nn>time</span>
<span class=kn>from</span> <span class=nn>network</span> <span class=kn>import</span> <span class=n>WLAN</span>

<span class=n>wlan</span> <span class=o>=</span> <span class=n>WLAN</span><span class=p>()</span> <span class=c1># get current object, without changing the mode</span>
<span class=k>if</span> <span class=n>machine</span><span class=o>.</span><span class=n>reset_cause</span><span class=p>()</span> <span class=o>!=</span> <span class=n>machine</span><span class=o>.</span><span class=n>SOFT_RESET</span><span class=p>:</span>
    <span class=n>wlan</span><span class=o>.</span><span class=n>init</span><span class=p>(</span><span class=n>mode</span><span class=o>=</span><span class=n>WLAN</span><span class=o>.</span><span class=n>STA</span><span class=p>)</span>
    <span class=c1># configuration below MUST match your home router settings!!</span>
    <span class=n>wlan</span><span class=o>.</span><span class=n>ifconfig</span><span class=p>(</span><span class=n>config</span><span class=o>=</span><span class=p>(</span><span class=s1>&#39;192.168.88.250&#39;</span><span class=p>,</span> <span class=s1>&#39;255.255.255.0&#39;</span><span class=p>,</span> <span class=s1>&#39;192.168.88.1&#39;</span><span class=p>,</span> <span class=s1>&#39;192.168.88.1&#39;</span><span class=p>))</span> <span class=c1># (ip, subnet_mask, gateway, DNS_server)</span>

<span class=k>if</span> <span class=ow>not</span> <span class=n>wlan</span><span class=o>.</span><span class=n>isconnected</span><span class=p>():</span>
    <span class=c1># change the line below to match your network ssid, security and password</span>
    <span class=n>wlan</span><span class=o>.</span><span class=n>connect</span><span class=p>(</span><span class=s1>&#39;IoT-dev-env&#39;</span><span class=p>,</span> <span class=n>auth</span><span class=o>=</span><span class=p>(</span><span class=n>WLAN</span><span class=o>.</span><span class=n>WPA2</span><span class=p>,</span> <span class=s1>&#39;12345678&#39;</span><span class=p>),</span> <span class=n>timeout</span><span class=o>=</span><span class=mi>5000</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;[INFO]</span><span class=se>\t</span><span class=s2>connecting&quot;</span><span class=p>,</span><span class=n>end</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>)</span>
    <span class=k>while</span> <span class=ow>not</span> <span class=n>wlan</span><span class=o>.</span><span class=n>isconnected</span><span class=p>():</span>
        <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
        <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;.&quot;</span><span class=p>,</span><span class=n>end</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>()</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;[INFO]</span><span class=se>\t</span><span class=s2>connected&quot;</span><span class=p>)</span>
</code></pre></div></p> <p>Резултата наблюдаван в <code>Pymakr Console</code> във <code>VSCode</code>:</p> <p><img alt=upload-static-up-result src=https://user-images.githubusercontent.com/47386361/148642828-dc091feb-0a09-498b-b0e9-ec34f1e59d58.png></p> <p>Ping резултат:</p> <p><img alt=PING_RESULT-upload-static-up-result src=https://user-images.githubusercontent.com/47386361/148642833-774abf37-a222-491c-ac0f-6701d540c56e.png></p> <h2 id=pybytes>Изпращане на данни към PyBytes<a class=headerlink href=#pybytes title="Permanent link">&para;</a></h2> <div class="admonition type info"> <p class=admonition-title>Устройстовто трябва да бъде активирано в платформата.</p> </div> <div class="admonition type info"> <p class=admonition-title>Трябва да дефинирате канала на който очаквате данни, тоест отидете в уеб интерфейса и отворете у-вото, в секция Signals -&gt; дефинирайте.</p> </div> <p>Тъй като за това отново се използва MQTT логиката е същата, но методите в кода са различни.</p> <p>В този пример ще изпращаме данни към PyBytes на всеки 5 секунди, тъй като все още използваме Expansion board-a, ще изпращаме синтетични данни. В следващи примери когато използваме някоя от сензорните разширителни платки ще изпратим реални данни.</p> <p><code>boot.py</code>: Свързваме се към мрежата.</p> <p>В <code>main.py</code>: <div class=highlight><pre><span></span><code><span class=c1># Import what is necessary to create a thread</span>
<span class=kn>import</span> <span class=nn>time</span>
<span class=kn>import</span> <span class=nn>math</span>

<span class=c1># Send data continuously to Pybytes</span>
<span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=mi>20</span><span class=p>):</span>
        <span class=n>pybytes</span><span class=o>.</span><span class=n>send_signal</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>math</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>i</span><span class=o>/</span><span class=mi>10</span><span class=o>*</span><span class=n>math</span><span class=o>.</span><span class=n>pi</span><span class=p>))</span>
        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;sent signal </span><span class=si>{}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>i</span><span class=p>))</span>
        <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
</code></pre></div></p> <p>Импортваме нужните библиотеки, Ще използваме няколко метода от <code>math</code> за да синтезираме данни. <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>time</span>
<span class=kn>import</span> <span class=nn>math</span>
</code></pre></div></p> <p>Продължително изпращаме данни към PyBytes на канал 1, съдържанието се пресмята всеки път. <div class=highlight><pre><span></span><code><span class=c1># Send data continuously to Pybytes</span>
<span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=mi>20</span><span class=p>):</span>
        <span class=c1># Това е реда който изпраща данните към платформата </span>
        <span class=n>pybytes</span><span class=o>.</span><span class=n>send_signal</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>math</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>i</span><span class=o>/</span><span class=mi>10</span><span class=o>*</span><span class=n>math</span><span class=o>.</span><span class=n>pi</span><span class=p>))</span>
        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;sent signal </span><span class=si>{}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>i</span><span class=p>))</span>
        <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
</code></pre></div></p> <p>Резултат:</p> <iframe width=600 height=315 src=https://user-images.githubusercontent.com/47386361/148675867-a5665c5b-57ab-4841-b71e-44748cbe0d5f.mp4> </iframe> <h2 id=mqtt>Свързване към MQTT<a class=headerlink href=#mqtt title="Permanent link">&para;</a></h2> <div class="admonition type info"> <p class=admonition-title>При този пример у-вото НЕ е активирано в платформата на PyBytes, тоест при флашване с Pycom Firmware update tool опцията Force pybytes activation и SmartConfig НЕ са отметнати</p> </div> <p>Сваляме сорс кода на MQTT клиента от <a href=https://github.com/pycom/pycom-libraries/blob/master/lib/mqtt/mqtt.py>тук</a>. Запазваме го в директория <code>lib</code> на проекта.</p> <p><code>boot.py</code> ще съдържа кода за свързване с мрежата: Това е кода от първия пример.</p> <div class=highlight><pre><span></span><code><span class=kn>from</span> <span class=nn>network</span> <span class=kn>import</span> <span class=n>WLAN</span>
<span class=kn>import</span> <span class=nn>machine</span>
<span class=n>wlan</span> <span class=o>=</span> <span class=n>WLAN</span><span class=p>(</span><span class=n>mode</span><span class=o>=</span><span class=n>WLAN</span><span class=o>.</span><span class=n>STA</span><span class=p>)</span>

<span class=n>nets</span> <span class=o>=</span> <span class=n>wlan</span><span class=o>.</span><span class=n>scan</span><span class=p>()</span>
<span class=k>for</span> <span class=n>net</span> <span class=ow>in</span> <span class=n>nets</span><span class=p>:</span>
    <span class=k>if</span> <span class=n>net</span><span class=o>.</span><span class=n>ssid</span> <span class=o>==</span> <span class=s1>&#39;IoT-dev-env&#39;</span><span class=p>:</span> <span class=c1># &lt;Your-Wifi-SSID&gt; е името на вашата мрежа</span>
        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;[INFO]</span><span class=se>\t</span><span class=s1>Network found!&#39;</span><span class=p>)</span>
        <span class=n>wlan</span><span class=o>.</span><span class=n>connect</span><span class=p>(</span><span class=n>net</span><span class=o>.</span><span class=n>ssid</span><span class=p>,</span> <span class=n>auth</span><span class=o>=</span><span class=p>(</span><span class=n>net</span><span class=o>.</span><span class=n>sec</span><span class=p>,</span> <span class=s1>&#39;12345678&#39;</span><span class=p>),</span> <span class=n>timeout</span><span class=o>=</span><span class=mi>5000</span><span class=p>)</span> <span class=c1># &lt;yourWifiKey&gt; Трябва да бъде паролата за вашата мрежа</span>
        <span class=k>while</span> <span class=ow>not</span> <span class=n>wlan</span><span class=o>.</span><span class=n>isconnected</span><span class=p>():</span>
            <span class=n>machine</span><span class=o>.</span><span class=n>idle</span><span class=p>()</span> <span class=c1># save power while waiting</span>
        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;[INFO]</span><span class=se>\t</span><span class=s1>WLAN connection succeeded!&#39;</span><span class=p>)</span>
        <span class=k>break</span>
    <span class=k>else</span><span class=p>:</span>
        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;[WARNING]</span><span class=se>\t</span><span class=s1>The network you are searching for could not be found.&#39;</span><span class=p>)</span>
        <span class=k>break</span>
</code></pre></div> <p>В <code>main.py</code> ще пишем кода който отговаря за свързването към брокера и изпращане и получване на съобщения. Коментари в кода:</p> <div class=highlight><pre><span></span><code><span class=kn>from</span> <span class=nn>mqtt</span> <span class=kn>import</span> <span class=n>MQTTClient</span> <span class=c1># this will be found in /lib directory</span>

<span class=kn>import</span> <span class=nn>time</span>

<span class=k>def</span> <span class=nf>sub_cb</span><span class=p>(</span><span class=n>topic</span><span class=p>,</span> <span class=n>msg</span><span class=p>):</span>
    <span class=sd>&quot;&quot;&quot;</span>
<span class=sd>    This function is executed everytime a new message</span>
<span class=sd>    arrives on the topic we have subscribed to.</span>
<span class=sd>    It prints the topic and the content of the message.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;New message arrived in topic &quot;</span><span class=p>,</span><span class=n>topic</span><span class=p>,</span><span class=s2>&quot; with content &quot;</span><span class=p>,</span> <span class=n>msg</span><span class=p>,</span> <span class=n>end</span> <span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>)</span>
    <span class=nb>print</span><span class=p>()</span>

<span class=c1># Create an instnace of the client, assigning the required</span>
<span class=c1># credentials for connecting to the broker. With flespi,</span>
<span class=c1># the password can be empty and the token is entered in</span>
<span class=c1># the username field.</span>
<span class=n>client</span> <span class=o>=</span> <span class=n>MQTTClient</span><span class=p>(</span><span class=s2>&quot;DeviceID-LoPy4&quot;</span><span class=p>,</span> <span class=s2>&quot;mqtt.flespi.io&quot;</span><span class=p>,</span><span class=n>user</span><span class=o>=</span><span class=s2>&quot;&lt;YourFlespiToken&gt;&quot;</span><span class=p>,</span><span class=n>password</span><span class=o>=</span><span class=s2>&quot;&quot;</span><span class=p>,</span><span class=n>port</span><span class=o>=</span><span class=mi>1883</span><span class=p>)</span>

<span class=c1># Register the callback function</span>
<span class=n>client</span><span class=o>.</span><span class=n>set_callback</span><span class=p>(</span><span class=n>sub_cb</span><span class=p>)</span>

<span class=c1># connect to the broker</span>
<span class=n>client</span><span class=o>.</span><span class=n>connect</span><span class=p>()</span>

<span class=c1># subcribe to the topic we want to listen for new messages</span>
<span class=n>client</span><span class=o>.</span><span class=n>subscribe</span><span class=p>(</span><span class=n>topic</span><span class=o>=</span><span class=s2>&quot;lopy4/test&quot;</span><span class=p>)</span>

<span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Sending message to the broker&quot;</span><span class=p>)</span>
    <span class=c1># Publish a message to the broker and all clients listening on this topic</span>
    <span class=n>client</span><span class=o>.</span><span class=n>publish</span><span class=p>(</span><span class=n>topic</span><span class=o>=</span><span class=s2>&quot;lopy4/test&quot;</span><span class=p>,</span> <span class=n>msg</span><span class=o>=</span><span class=s2>&quot;Hi from lopy4&quot;</span><span class=p>)</span>
    <span class=c1># sleep for 1 ms</span>
    <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
    <span class=c1># Check for new messages, if there are any the callback function will be executed.</span>
    <span class=n>client</span><span class=o>.</span><span class=n>check_msg</span><span class=p>()</span>

    <span class=c1># sleep again for a milisecond</span>
    <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
</code></pre></div> <p>Видео на резултата:</p> <iframe width=600 height=315 src=https://user-images.githubusercontent.com/47386361/148644229-dc6f1e57-f83b-4bf8-90c8-7812dd4278bc.mp4> </iframe> <h2 id=pybytes-third-party-mqtt-broker>PyBytes + third party MQTT Broker<a class=headerlink href=#pybytes-third-party-mqtt-broker title="Permanent link">&para;</a></h2> <div class="admonition type info"> <p class=admonition-title>За да бъдем свързани към PyBytes и да можем да изпращаме данни към платформата, у-вото трябва да е активирано по съответния начин</p> </div> <p>Тъй като Pybytes също използва MQTT, ако искаме да използваме отделна MQTT връзка докато същевременно сме във връзка с Pybytes, ще трябва да преименуваме класа MQTTCLient във файла mqtt.py, на (например) клас MQTTClient_lib, и да импортнем, като използваме новото име на класа (<em>from X import Z as Y</em>), за да избегнем конфликт на имената на класовете.</p> <p><code>boot.py</code>: Свързваме се към мрежата.</p> <p>В <code>main.py</code>: <div class=highlight><pre><span></span><code><span class=kn>from</span> <span class=nn>mqtt</span> <span class=kn>import</span> <span class=n>MQTTClient_lib</span> <span class=k>as</span> <span class=n>MQTTClient</span> <span class=c1># this will be found in /lib directory</span>
<span class=kn>import</span> <span class=nn>math</span>
<span class=kn>import</span> <span class=nn>time</span>

<span class=c1># Create an instnace of the client, assigning the required</span>
<span class=c1># credentials for connecting to the broker. With flespi,</span>
<span class=c1># the password can be empty and the token is entered in</span>
<span class=c1># the username field.</span>
<span class=n>client</span> <span class=o>=</span> <span class=n>MQTTClient</span><span class=p>(</span><span class=s2>&quot;DeviceID-LoPy4&quot;</span><span class=p>,</span> <span class=s2>&quot;mqtt.flespi.io&quot;</span><span class=p>,</span><span class=n>user</span><span class=o>=</span><span class=s2>&quot;&lt;YourFlespiToken&gt;&quot;</span><span class=p>,</span><span class=n>password</span><span class=o>=</span><span class=s2>&quot;&quot;</span><span class=p>,</span><span class=n>port</span><span class=o>=</span><span class=mi>1883</span><span class=p>)</span>

<span class=c1># connect to the broker</span>
<span class=n>client</span><span class=o>.</span><span class=n>connect</span><span class=p>()</span>

<span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=mi>20</span><span class=p>):</span>
        <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Generating synthetic data&quot;</span><span class=p>)</span>
        <span class=n>synth_data</span> <span class=o>=</span> <span class=n>math</span><span class=o>.</span><span class=n>sin</span><span class=p>(</span><span class=n>i</span><span class=o>/</span><span class=mi>10</span><span class=o>*</span><span class=n>math</span><span class=o>.</span><span class=n>pi</span><span class=p>)</span>

        <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Sending message to MQTT broker&quot;</span><span class=p>)</span>

        <span class=c1># Publish a message to the broker and all clients listening on this topic</span>
        <span class=n>client</span><span class=o>.</span><span class=n>publish</span><span class=p>(</span><span class=n>topic</span><span class=o>=</span><span class=s2>&quot;lopy4/test&quot;</span><span class=p>,</span> <span class=n>msg</span><span class=o>=</span><span class=nb>str</span><span class=p>(</span><span class=n>synth_data</span><span class=p>))</span>

        <span class=c1># Seng signal to PyBytes on channel 1 with the same data</span>
        <span class=n>pybytes</span><span class=o>.</span><span class=n>send_signal</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>synth_data</span><span class=p>)</span>

        <span class=c1># sleep for 1 ms</span>
        <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>

        <span class=c1># sleep for 10 miliseconds before iterating again</span>
        <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
</code></pre></div></p> <p>Резултатът наблюдаван и в двете платформи:</p> <iframe width=600 height=315 src=https://user-images.githubusercontent.com/47386361/148676811-8f9f1f17-218b-493d-9e79-0caa5dcceece.mp4> </iframe> <h2 id=python>Приемане на данни в Python скрипта<a class=headerlink href=#python title="Permanent link">&para;</a></h2> <p>Ще напишем Python скрипт който ще слуша на посочените теми и ще обработва получените данни. Ще използваме имплементацията <a href=https://github.com/wialon/gmqtt>gmqtt</a>. Предимството е, че е асинхронна по природа което олеснява работата.</p> <p>Създаваме виртуална Python среда и инсталираме gmqtt с pip. Аз работя с python версия 3.8.9, не би трябвало да има проблем с по-нови версии.</p> <p>В MS Win 10 powershell:</p> <p>Създаване на python virtual environment:</p> <p><code>python -m venv .venv</code></p> <p>Активиране на средата:</p> <p><code>.\.venv\Scripts\Activate.ps1</code></p> <p>Инсталиране на нужните библиотеки:</p> <p><code>python -m pip install gmqtt asyncio</code></p> <p>Код: <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>asyncio</span>
<span class=kn>import</span> <span class=nn>os</span>
<span class=kn>import</span> <span class=nn>signal</span>
<span class=kn>import</span> <span class=nn>time</span>

<span class=kn>from</span> <span class=nn>gmqtt</span> <span class=kn>import</span> <span class=n>Client</span> <span class=k>as</span> <span class=n>MQTTClient</span>

<span class=c1># gmqtt also compatibility with uvloop  </span>
<span class=c1># import uvloop</span>
<span class=c1># asyncio.set_event_loop_policy(uvloop.EventLoopPolicy())</span>


<span class=n>STOP</span> <span class=o>=</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>Event</span><span class=p>()</span>


<span class=k>def</span> <span class=nf>on_connect</span><span class=p>(</span><span class=n>client</span><span class=p>,</span> <span class=n>flags</span><span class=p>,</span> <span class=n>rc</span><span class=p>,</span> <span class=n>properties</span><span class=p>):</span>
    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Connected&#39;</span><span class=p>)</span>
    <span class=n>client</span><span class=o>.</span><span class=n>subscribe</span><span class=p>(</span><span class=s1>&#39;lopy4/test&#39;</span><span class=p>,</span> <span class=n>qos</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>


<span class=k>def</span> <span class=nf>on_message</span><span class=p>(</span><span class=n>client</span><span class=p>,</span> <span class=n>topic</span><span class=p>,</span> <span class=n>payload</span><span class=p>,</span> <span class=n>qos</span><span class=p>,</span> <span class=n>properties</span><span class=p>):</span>
    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;RECV MSG:&#39;</span><span class=p>,</span> <span class=n>payload</span><span class=p>)</span>


<span class=k>def</span> <span class=nf>on_disconnect</span><span class=p>(</span><span class=n>client</span><span class=p>,</span> <span class=n>packet</span><span class=p>,</span> <span class=n>exc</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Disconnected&#39;</span><span class=p>)</span>

<span class=k>def</span> <span class=nf>on_subscribe</span><span class=p>(</span><span class=n>client</span><span class=p>,</span> <span class=n>mid</span><span class=p>,</span> <span class=n>qos</span><span class=p>,</span> <span class=n>properties</span><span class=p>):</span>
    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;SUBSCRIBED&#39;</span><span class=p>)</span>

<span class=k>def</span> <span class=nf>ask_exit</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>):</span>
    <span class=n>STOP</span><span class=o>.</span><span class=n>set</span><span class=p>()</span>

<span class=k>async</span> <span class=k>def</span> <span class=nf>main</span><span class=p>(</span><span class=n>broker_host</span><span class=p>,</span> <span class=n>port</span><span class=p>,</span> <span class=n>token</span><span class=p>):</span>
    <span class=n>client</span> <span class=o>=</span> <span class=n>MQTTClient</span><span class=p>(</span><span class=s2>&quot;client-id&quot;</span><span class=p>)</span>

    <span class=n>client</span><span class=o>.</span><span class=n>on_connect</span> <span class=o>=</span> <span class=n>on_connect</span>
    <span class=n>client</span><span class=o>.</span><span class=n>on_message</span> <span class=o>=</span> <span class=n>on_message</span>
    <span class=n>client</span><span class=o>.</span><span class=n>on_disconnect</span> <span class=o>=</span> <span class=n>on_disconnect</span>
    <span class=n>client</span><span class=o>.</span><span class=n>on_subscribe</span> <span class=o>=</span> <span class=n>on_subscribe</span>

    <span class=n>client</span><span class=o>.</span><span class=n>set_auth_credentials</span><span class=p>(</span><span class=n>token</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
    <span class=k>await</span> <span class=n>client</span><span class=o>.</span><span class=n>connect</span><span class=p>(</span><span class=n>broker_host</span><span class=p>)</span>

    <span class=n>client</span><span class=o>.</span><span class=n>publish</span><span class=p>(</span><span class=s1>&#39;TEST/TIME&#39;</span><span class=p>,</span> <span class=nb>str</span><span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()),</span> <span class=n>qos</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>

    <span class=k>await</span> <span class=n>STOP</span><span class=o>.</span><span class=n>wait</span><span class=p>()</span>
    <span class=k>await</span> <span class=n>client</span><span class=o>.</span><span class=n>disconnect</span><span class=p>()</span>


<span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
    <span class=n>loop</span> <span class=o>=</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>get_event_loop</span><span class=p>()</span>

    <span class=n>broker_host</span> <span class=o>=</span> <span class=s1>&#39;mqtt.flespi.io&#39;</span>
    <span class=n>port</span> <span class=o>=</span> <span class=mi>1883</span>
    <span class=n>token</span> <span class=o>=</span> <span class=s2>&quot;&lt;YourFlespiToken&gt;&quot;</span>
    <span class=k>try</span><span class=p>:</span>
        <span class=n>loop</span><span class=o>.</span><span class=n>run_until_complete</span><span class=p>(</span><span class=n>main</span><span class=p>(</span><span class=n>broker_host</span><span class=p>,</span> <span class=n>port</span><span class=p>,</span> <span class=n>token</span><span class=p>))</span>
    <span class=k>except</span> <span class=ne>KeyboardInterrupt</span><span class=p>:</span>
        <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Received exit, exiting&quot;</span><span class=p>)</span>
</code></pre></div></p> <p>Обеснение:</p> <p>Импортваме нужните библиотеки: <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>asyncio</span>
<span class=kn>import</span> <span class=nn>os</span>
<span class=kn>import</span> <span class=nn>signal</span>
<span class=kn>import</span> <span class=nn>time</span>

<span class=kn>from</span> <span class=nn>gmqtt</span> <span class=kn>import</span> <span class=n>Client</span> <span class=k>as</span> <span class=n>MQTTClient</span>
</code></pre></div></p> <p>Дефинираме event handler за да можем да спрем всички изпълнявани задачи и да излезем правилно: <div class=highlight><pre><span></span><code><span class=n>STOP</span> <span class=o>=</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>Event</span><span class=p>()</span>
</code></pre></div></p> <p>Дефинираме функции за четирите основни момента - on_connect, on_disconnect, on_subscribe, on_message:</p> <p>Функцията се изпълнява в момента в който клиента ни е свързван към брокера. Тук е мястото да се абонираме към темата на която слушаме за данни: <div class=highlight><pre><span></span><code><span class=k>def</span> <span class=nf>on_connect</span><span class=p>(</span><span class=n>client</span><span class=p>,</span> <span class=n>flags</span><span class=p>,</span> <span class=n>rc</span><span class=p>,</span> <span class=n>properties</span><span class=p>):</span>
    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Connected&#39;</span><span class=p>)</span>
    <span class=n>client</span><span class=o>.</span><span class=n>subscribe</span><span class=p>(</span><span class=s1>&#39;lopy4/test&#39;</span><span class=p>,</span> <span class=n>qos</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</code></pre></div></p> <p>Изпълнява се всеки път когато съобщение е получено. Ако не сме абонирани към правилната тема никога няма да се изпълни:</p> <div class=highlight><pre><span></span><code><span class=k>def</span> <span class=nf>on_message</span><span class=p>(</span><span class=n>client</span><span class=p>,</span> <span class=n>topic</span><span class=p>,</span> <span class=n>payload</span><span class=p>,</span> <span class=n>qos</span><span class=p>,</span> <span class=n>properties</span><span class=p>):</span>
    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;RECV MSG:&#39;</span><span class=p>,</span> <span class=n>payload</span><span class=p>)</span>
</code></pre></div> <p>Изпълнява се в момента в който клиенти ни изгуби връзка с брокера. Тук може да се имплементира логика за last_will функционалност и т.н.: <div class=highlight><pre><span></span><code><span class=k>def</span> <span class=nf>on_disconnect</span><span class=p>(</span><span class=n>client</span><span class=p>,</span> <span class=n>packet</span><span class=p>,</span> <span class=n>exc</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Disconnected&#39;</span><span class=p>)</span>
</code></pre></div></p> <p>изпълнява се в момента в който се абонираме към тема. За момента приложението е основно за дебъг и прегледност: <div class=highlight><pre><span></span><code><span class=k>def</span> <span class=nf>on_subscribe</span><span class=p>(</span><span class=n>client</span><span class=p>,</span> <span class=n>mid</span><span class=p>,</span> <span class=n>qos</span><span class=p>,</span> <span class=n>properties</span><span class=p>):</span>
    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;SUBSCRIBED&#39;</span><span class=p>)</span>
</code></pre></div></p> <p>Дефинираме функция чрез която да кажем на loop-a да "убие" всички процеси. Изпълнява се при <code>Ctrl+C</code>: <div class=highlight><pre><span></span><code><span class=k>def</span> <span class=nf>ask_exit</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>):</span>
    <span class=n>STOP</span><span class=o>.</span><span class=n>set</span><span class=p>()</span>
</code></pre></div></p> <p>Основната функция на скрипта. Тук създаваме инстанция на своя MQTT клиент. Регистрираме функциите. Задаваме параметрите нужни за автентификация към брокера. Изпълняваме функциите за спиране на скрипта асинхронно, тоест без да блокират изпълнението на останалата част от кода. <div class=highlight><pre><span></span><code><span class=k>async</span> <span class=k>def</span> <span class=nf>main</span><span class=p>(</span><span class=n>broker_host</span><span class=p>,</span> <span class=n>port</span><span class=p>,</span> <span class=n>token</span><span class=p>):</span>
    <span class=n>client</span> <span class=o>=</span> <span class=n>MQTTClient</span><span class=p>(</span><span class=s2>&quot;client-id&quot;</span><span class=p>)</span>

    <span class=n>client</span><span class=o>.</span><span class=n>on_connect</span> <span class=o>=</span> <span class=n>on_connect</span>
    <span class=n>client</span><span class=o>.</span><span class=n>on_message</span> <span class=o>=</span> <span class=n>on_message</span>
    <span class=n>client</span><span class=o>.</span><span class=n>on_disconnect</span> <span class=o>=</span> <span class=n>on_disconnect</span>
    <span class=n>client</span><span class=o>.</span><span class=n>on_subscribe</span> <span class=o>=</span> <span class=n>on_subscribe</span>

    <span class=n>client</span><span class=o>.</span><span class=n>set_auth_credentials</span><span class=p>(</span><span class=n>token</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
    <span class=k>await</span> <span class=n>client</span><span class=o>.</span><span class=n>connect</span><span class=p>(</span><span class=n>broker_host</span><span class=p>)</span>

    <span class=n>client</span><span class=o>.</span><span class=n>publish</span><span class=p>(</span><span class=s1>&#39;TEST/TIME&#39;</span><span class=p>,</span> <span class=nb>str</span><span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()),</span> <span class=n>qos</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>

    <span class=k>await</span> <span class=n>STOP</span><span class=o>.</span><span class=n>wait</span><span class=p>()</span>
    <span class=k>await</span> <span class=n>client</span><span class=o>.</span><span class=n>disconnect</span><span class=p>()</span>
</code></pre></div></p> <p>Данни за MQTT брокера. Пускаме <code>loop</code>-а. Когато натиснем <code>Ctrl+C</code> ще се изпълни <code>except KeyboardInterrupt</code> блока и съответно функцията <code>ask_exit()</code> <div class=highlight><pre><span></span><code><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
    <span class=n>loop</span> <span class=o>=</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>get_event_loop</span><span class=p>()</span>

    <span class=n>broker_host</span> <span class=o>=</span> <span class=s1>&#39;mqtt.flespi.io&#39;</span>
    <span class=n>port</span> <span class=o>=</span> <span class=mi>1883</span>
    <span class=n>token</span> <span class=o>=</span> <span class=s2>&quot;&lt;YourFlespiToken&gt;&quot;</span>
    <span class=k>try</span><span class=p>:</span>
        <span class=n>loop</span><span class=o>.</span><span class=n>run_until_complete</span><span class=p>(</span><span class=n>main</span><span class=p>(</span><span class=n>broker_host</span><span class=p>,</span> <span class=n>port</span><span class=p>,</span> <span class=n>token</span><span class=p>))</span>
    <span class=k>except</span> <span class=ne>KeyboardInterrupt</span><span class=p>:</span>
        <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Received exit, exiting&quot;</span><span class=p>)</span>
</code></pre></div></p> <h3 id=_10>Препращане на данни към БД<a class=headerlink href=#_10 title="Permanent link">&para;</a></h3> <p>Работим върху кода от предишния пример.</p> <h4 id=mongodb-cloud>MongoDB Cloud<a class=headerlink href=#mongodb-cloud title="Permanent link">&para;</a></h4> <p>В същата виртуална среда на Python която използвхаме в предишната точка трябва да инсталираме изискванията за работа с MongoDB.</p> <p><code>python -m pip install dnspython pymongo</code> </p> <p>В скрипта импортваме <code>pymongo</code> и <code>datetime</code> за да добавим timestamp към записа: <div class=highlight><pre><span></span><code><span class=o>...</span>
<span class=kn>import</span> <span class=nn>pymongo</span>
<span class=kn>import</span> <span class=nn>datetime</span>
</code></pre></div></p> <p>Запазваме в променливи данните за автентификация към БД. <div class=highlight><pre><span></span><code><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
    <span class=n>DBUSER</span> <span class=o>=</span> <span class=s2>&quot;&lt;YourDBUsername&gt;&quot;</span>
    <span class=n>DBPWD</span> <span class=o>=</span> <span class=s2>&quot;&lt;YourDBUserPassword&gt;&quot;</span>
</code></pre></div></p> <p>Инстанциираме обект от класа <code>MongoClient</code>, като подаваме <code>connection string</code>-а форматирам с парола и потребител. <div class=highlight><pre><span></span><code>    <span class=c1># To create instance of the mongo client we need a connection string.</span>
    <span class=c1># Then we pass the connection string formatted with our user credentials as below:</span>
    <span class=n>db_client</span> <span class=o>=</span> <span class=n>pymongo</span><span class=o>.</span><span class=n>MongoClient</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;mongodb+srv://</span><span class=si>{</span><span class=n>DBUSER</span><span class=si>}</span><span class=s1>:</span><span class=si>{</span><span class=n>DBPWD</span><span class=si>}</span><span class=s1>@clusterdubnika16.ijloo.mongodb.net/iotDemo?retryWrites=true&amp;w=majority&#39;</span><span class=p>)</span>
    <span class=n>db</span> <span class=o>=</span> <span class=n>db_client</span><span class=o>.</span><span class=n>iotDemo</span>  <span class=c1># cursor to our DB</span>
    <span class=n>collection</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>pycomPython</span> <span class=c1># cursor to the collection</span>
    <span class=o>...</span>
</code></pre></div></p> <p>Логиката за препращане на данни ще имплементираме във функцията <code>on_message</code>. Обърнете внимание, че вече е дефинирана с ключовата дума <code>async</code>. В <code>recvTime</code> запазваме дата и час от момента на получване на съобщението. <div class=highlight><pre><span></span><code><span class=k>async</span> <span class=k>def</span> <span class=nf>on_message</span><span class=p>(</span><span class=n>client</span><span class=p>,</span> <span class=n>topic</span><span class=p>,</span> <span class=n>payload</span><span class=p>,</span> <span class=n>qos</span><span class=p>,</span> <span class=n>properties</span><span class=p>):</span>
    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;RECV MSG:&#39;</span><span class=p>,</span> <span class=n>payload</span><span class=p>)</span>
    <span class=n>recvTime</span> <span class=o>=</span> <span class=n>datetime</span><span class=o>.</span><span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span>
</code></pre></div></p> <p>Създаваме променлива от тип <code>dict</code> в която ще запазим <code>timestamp</code> и получения <code>payload</code> от MQTT съобщението. Тъй като данни получени от MQTT винаги са <code>binary</code> трябва да ги преобразуваме преди да ги запазим. Аз ще ги запазя като стринг. <div class=highlight><pre><span></span><code>    <span class=n>str_payload</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
    <span class=n>data</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s2>&quot;recvTime&quot;</span><span class=p>:</span> <span class=n>recvTime</span><span class=p>,</span>
        <span class=s2>&quot;payload&quot;</span><span class=p>:</span><span class=n>str_payload</span>
    <span class=p>}</span>
</code></pre></div></p> <p><img alt=mongo-records-beforeAfter-string-conv src=https://user-images.githubusercontent.com/47386361/148731765-14559381-2fe0-47f4-83ba-0bf9b351d72d.png></p> <p>За да запазим в БД използваме курсора към колекцията в баазата данни, тоест <code>collection</code> и по-точно <code>collection.insert_one()</code>. <div class=highlight><pre><span></span><code>    <span class=n>collection</span><span class=o>.</span><span class=n>insert_one</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</code></pre></div></p> <p>Крайния код е това: <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>asyncio</span>
<span class=kn>import</span> <span class=nn>os</span>
<span class=kn>import</span> <span class=nn>signal</span>
<span class=kn>import</span> <span class=nn>time</span>
<span class=kn>from</span> <span class=nn>gmqtt</span> <span class=kn>import</span> <span class=n>Client</span> <span class=k>as</span> <span class=n>MQTTClient</span>
<span class=kn>import</span> <span class=nn>pymongo</span>
<span class=kn>import</span> <span class=nn>datetime</span>

<span class=c1># gmqtt also compatibility with uvloop  </span>
<span class=c1># import uvloop</span>
<span class=c1># asyncio.set_event_loop_policy(uvloop.EventLoopPolicy())</span>


<span class=n>STOP</span> <span class=o>=</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>Event</span><span class=p>()</span>


<span class=k>def</span> <span class=nf>on_connect</span><span class=p>(</span><span class=n>client</span><span class=p>,</span> <span class=n>flags</span><span class=p>,</span> <span class=n>rc</span><span class=p>,</span> <span class=n>properties</span><span class=p>):</span>
    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Connected&#39;</span><span class=p>)</span>
    <span class=n>client</span><span class=o>.</span><span class=n>subscribe</span><span class=p>(</span><span class=s1>&#39;lopy4/test&#39;</span><span class=p>,</span> <span class=n>qos</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>


<span class=c1># def on_message(client, topic, payload, qos, properties):</span>

<span class=c1>#     print(&#39;RECV MSG:&#39;, payload)</span>

<span class=k>async</span> <span class=k>def</span> <span class=nf>on_message</span><span class=p>(</span><span class=n>client</span><span class=p>,</span> <span class=n>topic</span><span class=p>,</span> <span class=n>payload</span><span class=p>,</span> <span class=n>qos</span><span class=p>,</span> <span class=n>properties</span><span class=p>):</span>
    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;RECV MSG:&#39;</span><span class=p>,</span> <span class=n>payload</span><span class=p>)</span>
    <span class=n>recvTime</span> <span class=o>=</span> <span class=n>datetime</span><span class=o>.</span><span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span>
    <span class=n>str_payload</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
    <span class=n>data</span> <span class=o>=</span> <span class=p>{</span>
        <span class=s2>&quot;recvTime&quot;</span><span class=p>:</span> <span class=n>recvTime</span><span class=p>,</span>
        <span class=s2>&quot;payload&quot;</span><span class=p>:</span><span class=n>str_payload</span>
    <span class=p>}</span>
    <span class=n>collection</span><span class=o>.</span><span class=n>insert_one</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>

<span class=k>def</span> <span class=nf>on_disconnect</span><span class=p>(</span><span class=n>client</span><span class=p>,</span> <span class=n>packet</span><span class=p>,</span> <span class=n>exc</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Disconnected&#39;</span><span class=p>)</span>

<span class=k>def</span> <span class=nf>on_subscribe</span><span class=p>(</span><span class=n>client</span><span class=p>,</span> <span class=n>mid</span><span class=p>,</span> <span class=n>qos</span><span class=p>,</span> <span class=n>properties</span><span class=p>):</span>
    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;SUBSCRIBED&#39;</span><span class=p>)</span>

<span class=k>def</span> <span class=nf>ask_exit</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>):</span>
    <span class=n>STOP</span><span class=o>.</span><span class=n>set</span><span class=p>()</span>

<span class=k>async</span> <span class=k>def</span> <span class=nf>main</span><span class=p>(</span><span class=n>broker_host</span><span class=p>,</span> <span class=n>port</span><span class=p>,</span> <span class=n>token</span><span class=p>):</span>

    <span class=n>client</span> <span class=o>=</span> <span class=n>MQTTClient</span><span class=p>(</span><span class=s2>&quot;client-id&quot;</span><span class=p>)</span>

    <span class=n>client</span><span class=o>.</span><span class=n>on_connect</span> <span class=o>=</span> <span class=n>on_connect</span>
    <span class=n>client</span><span class=o>.</span><span class=n>on_message</span> <span class=o>=</span> <span class=n>on_message</span>
    <span class=n>client</span><span class=o>.</span><span class=n>on_disconnect</span> <span class=o>=</span> <span class=n>on_disconnect</span>
    <span class=n>client</span><span class=o>.</span><span class=n>on_subscribe</span> <span class=o>=</span> <span class=n>on_subscribe</span>

    <span class=n>client</span><span class=o>.</span><span class=n>set_auth_credentials</span><span class=p>(</span><span class=n>token</span><span class=p>,</span> <span class=kc>None</span><span class=p>)</span>
    <span class=k>await</span> <span class=n>client</span><span class=o>.</span><span class=n>connect</span><span class=p>(</span><span class=n>broker_host</span><span class=p>)</span>

    <span class=n>client</span><span class=o>.</span><span class=n>publish</span><span class=p>(</span><span class=s1>&#39;TEST/TIME&#39;</span><span class=p>,</span> <span class=nb>str</span><span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()),</span> <span class=n>qos</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>

    <span class=k>await</span> <span class=n>STOP</span><span class=o>.</span><span class=n>wait</span><span class=p>()</span>
    <span class=k>await</span> <span class=n>client</span><span class=o>.</span><span class=n>disconnect</span><span class=p>()</span>


<span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
    <span class=n>DBUSER</span> <span class=o>=</span> <span class=s2>&quot;&lt;YourDBUsername&gt;&quot;</span>
    <span class=n>DBPWD</span> <span class=o>=</span> <span class=s2>&quot;&lt;YourDBUserPassword&gt;&quot;</span>
    <span class=c1># To create instance of the mongo client we need a connection string.</span>
    <span class=c1># Then we pass the connection string formatted with our user credentials as below:</span>
    <span class=n>db_client</span> <span class=o>=</span> <span class=n>pymongo</span><span class=o>.</span><span class=n>MongoClient</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;mongodb+srv://</span><span class=si>{</span><span class=n>DBUSER</span><span class=si>}</span><span class=s1>:</span><span class=si>{</span><span class=n>DBPWD</span><span class=si>}</span><span class=s1>@clusterdubnika16.ijloo.mongodb.net/iotDemo?retryWrites=true&amp;w=majority&#39;</span><span class=p>)</span>
    <span class=n>db</span> <span class=o>=</span> <span class=n>db_client</span><span class=o>.</span><span class=n>iotDemo</span>  <span class=c1># cursor to our DB</span>
    <span class=n>collection</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>pycomPython</span> <span class=c1># cursor to the collection</span>

    <span class=n>loop</span> <span class=o>=</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>get_event_loop</span><span class=p>()</span>
    <span class=n>broker_host</span> <span class=o>=</span> <span class=s1>&#39;mqtt.flespi.io&#39;</span>
    <span class=n>port</span> <span class=o>=</span> <span class=mi>1883</span>
    <span class=n>token</span> <span class=o>=</span> <span class=s2>&quot;&lt;YourFlespiToken&gt;&quot;</span>
    <span class=k>try</span><span class=p>:</span>
        <span class=n>loop</span><span class=o>.</span><span class=n>run_until_complete</span><span class=p>(</span><span class=n>main</span><span class=p>(</span><span class=n>broker_host</span><span class=p>,</span> <span class=n>port</span><span class=p>,</span> <span class=n>token</span><span class=p>))</span>
    <span class=k>except</span> <span class=ne>KeyboardInterrupt</span><span class=p>:</span>
        <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Received exit, exiting&quot;</span><span class=p>)</span>
</code></pre></div></p> <h2 id=_11>Интегриране с услуги предоставени от трети страни<a class=headerlink href=#_11 title="Permanent link">&para;</a></h2> <!--
## LoPy +

Ще разгледаме използването й с няколко различни разширителни платки.


### Expansion Board

### PySense2x

### PyScan

### PyTrack2x
--> </article> </div> </div> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../../test-pybytes-webhook/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Test the hook(Mock webhook service/backend/endpoint)" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> Test the hook(Mock webhook service/backend/endpoint) </div> </div> </a> <a href=../pyscan/ class="md-footer__link md-footer__link--next" aria-label="Next: Pyscan" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> Pyscan </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/46265z target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["header.autohide", "navigation.instant", "navigation.sections", "navigation.tabs"], "search": "../../assets/javascripts/workers/search.2a1c317c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script> <script src=../../assets/javascripts/bundle.ed9748b7.min.js></script> </body> </html>